<?xml version="1.0" encoding="utf-8"?>
<!--
////////////////////////////////////////////////////////////////////////////////
//
//  Author ILYA GOLOVACH (aka IngweLand)
//  http://ingweland.com
//  ingweland@gmail.com
//  2012
//
////////////////////////////////////////////////////////////////////////////////
-->

<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009"
                       xmlns:s="library://ns.adobe.com/flex/spark"
                       xmlns:mx="library://ns.adobe.com/flex/mx"
                       currentState="bootState"
                       xmlns:ui="com.ingweland.imageNetUploader.view.ui.*" xmlns:local="*"
                       >
    <fx:Style source="Styles.css"/>
    <fx:Script>
    <![CDATA[
        import com.ingweland.imageNetUploader.events.controller.LoginEvent;
        import com.ingweland.imageNetUploader.events.model.StartupEvent;

        public function changeState(event:Event):void
        {
            if(event is LoginEvent && event.type == LoginEvent.LOGIN_SUCCESSFUL)
            {
                currentState = "uploadState";
            }
            else if(event is StartupEvent && event.type == StartupEvent.CONFIG_LOADED)
            {
                currentState = "loginState";
            }
        }

    ]]>
    </fx:Script>
    <fx:Declarations>
        <local:ImageNetUploaderContext contextView="{this}"/>
    </fx:Declarations>
    <s:states>
        <s:State name="bootState"/>
        <s:State name="loginState"/>
        <s:State name="uploadState"/>
    </s:states>
    <s:transitions>
        <s:Transition fromState="*" toState="*" autoReverse="true">
            <s:Fade duration="300"/>
        </s:Transition>
    </s:transitions>
    <s:Rect width="100%" height="100%">
        <s:fill>
            <s:LinearGradient rotation="90">
                <s:GradientEntry color="0xffffff" ratio="0"/>
                <s:GradientEntry color="0xe8e8e8" ratio="1"/>
            </s:LinearGradient>
        </s:fill>
    </s:Rect>
    <s:BitmapImage x="10" y="10" source="@Embed(source='assets/images/logo.png')"/>
    <ui:LoginScreen includeIn="loginState" verticalCenter="0" horizontalCenter="0" id="loginScreen"/>
    <ui:UploadScreen includeIn="uploadState" width="100%" top="60" bottom="0"/>
</s:WindowedApplication>
